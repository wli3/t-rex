<Project>
  <PropertyGroup>
    <TargetsForTfmSpecificContentInPackage>$(TargetsForTfmSpecificBuildOutput);AddPackageFiles</TargetsForTfmSpecificContentInPackage>
    <PackageType>DotnetTool</PackageType>
    <IncludeBuildOutput>false</IncludeBuildOutput>
  </PropertyGroup>

  <ItemGroup>
    <PackageReference Update="@(PackageReference)">
      <PrivateAssets>All</PrivateAssets>
      <Publish Condition=" '%(PackageReference.Publish)' != 'false' ">true</Publish>
    </PackageReference>
  </ItemGroup>

  <ItemGroup>
    <ProjectReference Update="@(ProjectReference)">
      <PrivateAssets>All</PrivateAssets>
      <Publish Condition=" '%(ProjectReference.Publish)' != 'false' ">true</Publish>
    </ProjectReference>
  </ItemGroup>

  <Target Name="AddPackageFiles" DependsOnTargets="Publish">
    <ItemGroup>
      <TfmSpecificPackageFile Include="$(PublishDir)/**/*.*">
        <PackagePath>tools/$(targetframework)/any</PackagePath>
      </TfmSpecificPackageFile>
    </ItemGroup>
  </Target>

  <ItemGroup>
    <TfmSpecificPackageFile Include="$(MSBuildThisFileDirectory)/DotnetToolSettings.xml">
      <PackagePath>tools/$(targetframework)/any</PackagePath>
    </TfmSpecificPackageFile>
  </ItemGroup>
</Project>
